<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Scraping: Messy and Mangled | R Module 2</title>
  <meta name="description" content="This is the second installment for the book for the R Intro Course at CSU." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Scraping: Messy and Mangled | R Module 2" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the second installment for the book for the R Intro Course at CSU." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Scraping: Messy and Mangled | R Module 2" />
  
  <meta name="twitter:description" content="This is the second installment for the book for the R Intro Course at CSU." />
  

<meta name="author" content="Connor Gibbs" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="apis-clean-and-curated.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="src\style.css" type="text/css" />
<link rel="stylesheet" href="src\environments.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Module 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome!</a><ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#how-to-navigate-this-book"><i class="fa fa-check"></i><b>1.0.1</b> How To Navigate This Book</a></li>
<li class="chapter" data-level="1.1" data-path="associated-csu-course.html"><a href="associated-csu-course.html"><i class="fa fa-check"></i><b>1.1</b> Associated CSU Course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="AccessingData.html"><a href="AccessingData.html"><i class="fa fa-check"></i><b>2</b> Accessing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="rectangular-vs-non-rectangular-data.html"><a href="rectangular-vs-non-rectangular-data.html"><i class="fa fa-check"></i><b>2.1</b> Rectangular vs.Â Non-rectangular Data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="rectangular-vs-non-rectangular-data.html"><a href="rectangular-vs-non-rectangular-data.html#reading-and-writing-rectangular-data"><i class="fa fa-check"></i><b>2.1.1</b> Reading and Writing Rectangular Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="rectangular-vs-non-rectangular-data.html"><a href="rectangular-vs-non-rectangular-data.html#reading-and-writing-non-rectangular-data"><i class="fa fa-check"></i><b>2.1.2</b> Reading and Writing Non-rectangular Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="apis-clean-and-curated.html"><a href="apis-clean-and-curated.html"><i class="fa fa-check"></i><b>2.2</b> APIs: Clean and Curated</a></li>
<li class="chapter" data-level="2.3" data-path="scraping-messy-and-mangled.html"><a href="scraping-messy-and-mangled.html"><i class="fa fa-check"></i><b>2.3</b> Scraping: Messy and Mangled</a><ul>
<li class="chapter" data-level="2.3.1" data-path="scraping-messy-and-mangled.html"><a href="scraping-messy-and-mangled.html#scraping-vs-api"><i class="fa fa-check"></i><b>2.3.1</b> Scraping vs API</a></li>
<li class="chapter" data-level="2.3.2" data-path="scraping-messy-and-mangled.html"><a href="scraping-messy-and-mangled.html#hypertext-markup-language-html-and-selector-gadgets"><i class="fa fa-check"></i><b>2.3.2</b> Hypertext Markup Language (HTML) and Selector Gadgets</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Module 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scraping-messy-and-mangled" class="section level2">
<h2><span class="header-section-number">2.3</span> Scraping: Messy and Mangled</h2>
<p>If you are reading this textbook, at some point in your career, you are likely to want or need data which exists on the web. You have looked for downloadable sources and Google searched for an API, but alas, no luck. The last resort for importing data into <code>R</code> is <strong>web scraping</strong>. Web scraping is a technique for harvesting data which is portrayed on the web and exists in hypertext markup language (HTML), the language of web browser documents.</p>
<div id="scraping-vs-api" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Scraping vs API</h3>
<p>The benefit of using an API are clean data. For example, we can traverse the result to find the latest NFL events.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r chunk-style"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">head</span>(bov_res[[<span class="dv">2</span>]][[<span class="dv">1</span>]][,<span class="dv">2</span>])</a></code></pre></div>
<pre class="output-style"><code>[1] &quot;Cincinnati Bengals @ Cleveland Browns&quot;   
[2] &quot;Atlanta Falcons @ Dallas Cowboys&quot;        
[3] &quot;Buffalo Bills @ Miami Dolphins&quot;          
[4] &quot;Carolina Panthers @ Tampa Bay Buccaneers&quot;
[5] &quot;Denver Broncos @ Pittsburgh Steelers&quot;    
[6] &quot;Detroit Lions @ Green Bay Packers&quot;       </code></pre>
<p>With more digging, we can find which teams are playing at home.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r chunk-style"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">head</span>(bov_res[[<span class="dv">2</span>]][[<span class="dv">1</span>]][[<span class="dv">16</span>]])</a></code></pre></div>
<pre class="output-style"><code>[[1]]
                id               name  home
1 7410847-11904219   Cleveland Browns  TRUE
2 7410847-11904217 Cincinnati Bengals FALSE

[[2]]
                id            name  home
1 7410866-11904234  Dallas Cowboys  TRUE
2 7410866-11904242 Atlanta Falcons FALSE

[[3]]
                id           name  home
1 7410932-11904224 Miami Dolphins  TRUE
2 7410932-11904215  Buffalo Bills FALSE

[[4]]
                id                 name  home
1 7410868-11904225 Tampa Bay Buccaneers  TRUE
2 7410868-11904216    Carolina Panthers FALSE

[[5]]
                id                name  home
1 7410927-11904223 Pittsburgh Steelers  TRUE
2 7410927-11904245      Denver Broncos FALSE

[[6]]
                id              name  home
1 7410940-11904228 Green Bay Packers  TRUE
2 7410940-11904244     Detroit Lions FALSE</code></pre>
<p>We can also find the current line of each of these games.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r chunk-style"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">library</span>(rlist, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb29-2" title="2">bov_res[[<span class="dv">2</span>]][[<span class="dv">1</span>]][[<span class="dv">17</span>]] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span><span class="kw">map</span>(., <span class="op">~</span>.x[[<span class="st">&#39;markets&#39;</span>]]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">  </span><span class="kw">map</span>(., <span class="op">~</span><span class="kw">pluck</span>(.x, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span><span class="kw">map</span>(., <span class="op">~</span>.x[[<span class="st">&#39;outcomes&#39;</span>]]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="st">  </span><span class="kw">map</span>(., <span class="op">~</span><span class="kw">pluck</span>(.x, <span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-7" title="7"><span class="st">  </span>rlist<span class="op">::</span><span class="kw">list.filter</span>(., <span class="kw">all</span>(<span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;H&#39;</span>) <span class="op">%in%</span><span class="st"> </span>type)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="st">  </span><span class="kw">map</span>(., <span class="op">~</span><span class="kw">bind_cols</span>(.x, <span class="kw">select</span>(.x<span class="op">$</span>price, <span class="op">-</span>id))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="st">  </span><span class="kw">map</span>(., <span class="op">~</span><span class="kw">select</span>(.x, description, handicap, american)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="st">  </span><span class="kw">head</span>()</a></code></pre></div>
<pre class="output-style"><code>[[1]]
         description handicap american
1 Cincinnati Bengals      6.0     -115
2   Cleveland Browns     -6.0     -105

[[2]]
      description handicap american
1 Atlanta Falcons      4.0     -105
2  Dallas Cowboys     -4.0     -115

[[3]]
     description handicap american
1  Buffalo Bills     -6.0     -105
2 Miami Dolphins      6.0     -115

[[4]]
           description handicap american
1    Carolina Panthers      9.0     -110
2 Tampa Bay Buccaneers     -9.0     -110

[[5]]
          description handicap american
1      Denver Broncos      7.5     -110
2 Pittsburgh Steelers     -7.5     -110

[[6]]
        description handicap american
1     Detroit Lions      6.5     -115
2 Green Bay Packers     -6.5     -105</code></pre>
<p>While traversing these sometimes complicated lists may seem intimidating, with practice, working with data from an API is like a walk in the park compared to scraping data directly from the web.</p>
</div>
<div id="hypertext-markup-language-html-and-selector-gadgets" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Hypertext Markup Language (HTML) and Selector Gadgets</h3>
<p>Web sites are written in hypertext markup language. All contents that are displayed on a web page are structured through HTML with the help of HTML <strong>elements</strong>. HTML elements consist of a tag and contents. The <strong>tag</strong> defines how the web browser should format and display the content. Aptly, the <strong>content</strong> is what should be displayed.</p>
<p>For example, if we wished to format text as a paragraph within the web document, then we could use the paragraph tag, <code>&lt;p&gt;</code>, to indicate the beginning of a paragraph. After opening a tag, we then specify the content to display before closing the tag. A complete paragraph may read:</p>
<p><code>&lt;p&gt; This is the paragraph you want to scrape. &lt;/p&gt;</code></p>
<p><strong>Attributes</strong> are optional parameters which provide additional information about the element in which the attribute is included. For example, within the paragraph tag, you can define a class which</p>
<div class="feedback">
<p>
Any feedback for this section? Click <a href="https://docs.google.com/forms/d/e/1FAIpQLSePQZ3lIaCIPo9J2owXImHZ_9wBEgTo21A0s-A1ty28u4yfvw/viewform?entry.1684471501=The%20R%20Community">here</a>
</p>
</div>

</div>
</div>
<!-- </div> -->






            </section>

          </div>
        </div>
      </div>
<a href="apis-clean-and-curated.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Module2.pdf", "Module2.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
